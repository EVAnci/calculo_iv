\section{Residuos}

Un concepto muy importante que surge de la serie de Laurent es el de \textit{residuo}, con gran aplicación en el capítulo de transformada de Laplace y permite definir uno de los métodos más prácticos de antitransformación.

Para ver una conexión entre la serie de Laurent y la integral de una función, suponga que $f$ tiene un desarrollo de Laurent 
$$
f(z)=\sum_{-\infty}^\infty c_n(z-z_0)^n 
$$
en algún anillo $0<\lvert z-z_0\rvert <R$. Sea $\Gamma$ una trayectoria cerrada en este anillo que encierra a $z_0$. De acuerdo con el teorema \ref{teo:laurent} (serie de Laurent), los coeficientes de Laurent están dados por una fórmula integral. En particular el coeficiente $1/(z-z_0)$ es 
$$
c_{-1}=\frac{1}{j2\pi}\oint_\Gamma f(z)dz
$$
Por tanto,
$$
\oint_\Gamma f(z)dz=j2\pi (c_{-1})
$$
Si conoce este coeficiente en el desarrollo de Laurent puede obtener el valor de esta integral. Este hecho da una importancia especial a este coeficiente, de manera que tomará el nombre de \textit{residuo}. Como ya hemos visto en ejemplos anteriores, es posible conocer la serie de Laurent de una función sin tener que calcular los coeficientes. Entonces, puede encontrarse la serie de Laurent usando alguno de los métodos utilizados en los ejemplos a fin de evaluar la integral.

\begin{definition}[Residuo]
  Sea $f$ con una singularidad aislada en $z_0$ y desarrollo de Laurent $f(z)=\sum_{n=-\infty}^\infty c_n(z-z_0)^n$ en alguna corona $0<\lvert z-z_0\rvert < R$. Entonces el coeficiente $c_{-1}$ se llama \textbf{residuo} de $f$ en $z_0$ y se denota 
  $$
  \res_{z=z_0}f(z) \qquad \text{o bien} \qquad \text{Res}\left[f(z) \right\rvert_{z=z_0}
  $$
  o también puede encontrarse como $\text{Res}(f,z_0)$ en algunas bibliografías. Nosotros, preferentemente usaremos la primera notación ya que es más compacta.
\end{definition}

Esta idea puede extenderse para el caso en que $\Gamma$ encierra múltiples singularidades.
\input{chapters/3_residuos/media/residuos.tex}

\begin{theorem}[Teorema del residuo]
  Sea $\Gamma$ una trayectoria cerrada y $f$ diferenciable en $\Gamma$ y en todos los puntos encerrados por $\Gamma$, excepto para $z_1,~z_2,\dots,~z_n$, que son todas singularidades aisladas de $f$ encerradas por $\Gamma$ (ver figura \ref{fig:residuos}). Entonces
  $$
  \oint_\Gamma f(z)dz = j2\pi\sum_{k=1}^n \res_{z=z_k}f(z)
  $$
  En palabras, el valor de esta integral es $j2\pi$ veces la suma de los residuos de $f$ en las singularidades de $f$ encerradas por $\Gamma$. 
\end{theorem}

\begin{proof}
  Encerramos cada una de las singularidades $z_k$ en una trayectoria cerrada $\gamma_k$ que quede contenida dentro de $\Gamma$, que no encierre otras singularidades y que no interseque ninguna otra $\gamma_m$. Por el teorema de la deformación para dominios de conexidad superior (o segundo colorario de Cauchy, ecuación \ref{eq:dom_de_conex_sup}),
  $$
  \oint_\Gamma f(z)dz = \sum_{k=1}^n \oint_{\gamma_k}f(z)dz = j2\pi \sum_{k=1}^n \res_{z=z_k}f(z)
  $$
  quedando demostrado.
\end{proof}

El teorema del residuo es efectivo en la medida de nuestra eficiencia para evaluar los residuos de una función en sus singularidades. Si realmente tuviera que escribir el desarrollo de Laurent de $f$ alrededor de cada singularidad para mostrar el coeficiente del $1/(z-z_k)$ término, el teorema sería difícil de aplicar en muchos ejemplos. Lo que aumenta su importancia, es que, al menos para los polos, es una manera eficiente de calcular los residuos.

\subsection{Evaluación de los residuos}

Para que esta forma de resolver integrales pueda implementarse y resultar de utilidad, es necesario encontrar la manera de evaluar los residuos.

Tal como se verá, resulta más fácil evaluar y calcular un residuo que resolver una integral, por lo que este método constituye un aporte interesante en la resolución de integrales complejas.

Antes de proseguir con la integración, se pregunta lo siguiente. Para obtener un residuo, un simple coeficiente de una serie de Laurent ¿es necesario obtener toda la serie o existe una manera más económica? Para polos, la respuesta es que si existe una manera más económica. 

Entonces se deben distinguir las diferentes posibilidades que pueden presentarse para definir un residuo, a saber:
\begin{itemize}
  \item Residuo en un polo simple,
  \item Residuo en un polo múltiple,
  \item Residuo en el infinito.
\end{itemize}

\begin{theorem}[Residuo en un polo simple]
  Si $f$ tiene un polo simple en $z_0$. Entonces 
  $$
  \boxed{\res_{z=z_0} f(z) = \lim_{z\to z_0}(z-z_0)f(z)}
  $$
  es el residuo de $f$ en $z_0$.
\end{theorem}
\begin{proof}
  Si $f$ tiene un polo simple en $z_0$, entonces su desarrollo de Laurent alrededor de $z_0$ es 
  $$
  f(z)=\frac{c_{-1}}{z-z_0}+\sum_{k=0}^\infty c_k(z-z_0)^k
  $$
  ya que, es la serie de Taylor más la parte principal de la serie de Laurent, que, como tiene un polo simple, tiene un único término en alguna corona $0<\lvert z-z_0\rvert <R$. Entonces, si despejamos $c_{-1}$
  \begin{align*}
    f(z)&= \frac{c_{-1}}{z-z_0} + \sum_{k=0}^\infty c_k\frac{(z-z_0)^{k+1}}{(z-z_0)} \\ 
    f(z)&=\frac{1}{z-z_0}\left( c_{-1} + \sum_{k=0}^\infty c_k(z-z_0)^{k+1} \right) \\ 
    (z-z_0)f(z)&=c_{-1} + \sum_{k=0}^\infty c_k(z-z_0)^{k+1} 
  \end{align*}
  así, podemos hacer que la sumatoria converja a cero aplicando un límite 
  \begin{align*}
    \lim_{z\to z_0} (z-z_0)f(z) &= \lim_{z\to z_0} c_{-1}\sum_{k=0}^\infty c_k(z-z_0)^{k+1} \\ 
    \lim_{z\to z_0} (z-z_0)f(z) &= c_{-1} = \res_{z=z_0} f(z)
  \end{align*}
  quedando entonces la expresión que se quería demostrar.
\end{proof}

Otra fórmula, que algunas veces es más simple, para obtener el residuo en un polo simple se obtiene empezando con 
$$
f(z)=\frac{p(z)}{q(z)}
$$
con $p(z)$ y $q(z)$ analíticas, en donde se supone que $p(z_0)\neq 0$ y $q(z)$ tiene un cero simple en $z=z_0$ (de modo que, por el teorema \ref{teo:polos_y_ceros} de polos y ceros, tiene un polo simple en $z=z_0$, como se desea). Por la definición de cero simple, $q(z)$ tiene una serie de Taylor de la forma 
$$
q(z) = \sum_{k=1}^\infty q^{(k)}(z)(z-z_0)^k = q'(z_0)(z-z_0)+q''(z_0)\frac{(z-z_0)^2}{2!} + \dots
$$
Esta serie se sustituye en $f=p/q$ y después $f$ se sustituye en la fórmula de residuo
\begin{align*}
  \res_{z=z_0}&=\lim_{z\to z_0}(z-z_0)\frac{p(z)}{q(z)} \\ 
              &= \lim_{z\to z_0}\frac{(z-z_0)p(z)}{(z-z_0)\sum_{k=1}^\infty q^{(k)}(z)(z-z_0)^{k-1}} \\ 
              &= \lim_{z\to z_0}\frac{p(z)}{q'(z)}
\end{align*}
Pasando en limpio resulta 
$$
\boxed{\res_{z=z_0}f(z)=\res_{z=z_0}\frac{p(z)}{q(z)}=\frac{p(z_0)}{q'(z_0)}}
$$

Para terminar de afianzar los conceptos veamos un ejemplo.

\begin{example}
  Evaluar 
  $$
  \oint_\Gamma \frac{j4z-1}{\sin(z)}\,dz
  $$
  con $\Gamma$ la trayectoria cerrada de la figura \ref{fig:ej:polos}. 
  \begin{figure}[ht]
    \centering
    \begin{tikzpicture}[>=stealth]
      \draw[->,gray] (-1.5,0) -- (3.2,0);
      \draw[->,gray] (0,-2) -- (0,2);
      \foreach \i\a in {-1/-,1/,2/2,3/3} {
        \draw[gray] (\i,2pt) -- (\i,-2pt) node[below] {\scriptsize$\a\pi$};
      }
      \node[gray,below right] at (0,0) {\scriptsize$0$};
      \foreach \i in {-1,0,1,2} {
        \draw[fill] (\i,0) circle (1pt);
      }
      \begin{scope}[decoration={
          markings,
          mark=at position 0.1 with {\arrow{>}},
          mark=at position 0.4 with {\arrow{>}},
          mark=at position 0.7 with {\arrow{>}},
          mark=at position 0.9 with {\arrow{>} \node[above right] {\color{black}$\Gamma$};},
        }]
        \draw[gray,very thick,postaction={decorate}] (0,1.5) to [out=180,in=90] (-1.5,0.8)
          to [out=270,in=90] (-1.2,0.3)
          to [out=270,in=135] (-1.4,-1)
          to [out=315,in=180] (0,-0.5)
          to [out=0,in=180] (1.3,-2)
          to [out=0,in=240] (1.2,-0.5)
          to [out=60,in=270] (2.4,0)
          to [out=90,in=0] (0,1.5);
      \end{scope}
    \end{tikzpicture}
    \caption{$\Gamma$ encierra solamente las singularidades $-\pi,0,\pi,2\pi$ de $f$.}
    \label{fig:ej:polos}
  \end{figure}
  $\Gamma$ encierra los polos $-\pi,0,\pi,2\pi$ pero no otras singularidades de $f$. Por el teorema del residuo:
  \begin{equation}
    \oint_\Gamma \frac{j4z-1}{\sin(z)}dz = j2\pi\left(\res_{z=-\pi}f(z)+\res_{z=0}f(z)+\res_{z=\pi}f(z)+\res_{z=2\pi}f(z)\right)
    \label{eq:ej:polos}
  \end{equation}
  Aquí tenemos que 
  $$
  \res_{z=z_0}\frac{j4z-1}{\sin(z)}=\frac{j4z_0-1}{\cos(z_0)}
  $$
  Entonces, evaluando cada uno de los residuos en \eqref{eq:ej:polos}, resulta
  $$
    \oint_\Gamma \frac{j4z-1}{\sin(z)}dz = j2\pi \left( (j4\pi+1) + (-1) + (-j4\pi+1) + (j8\pi-1) \right)
  $$
  reescribiendo todo, el resultado de la integral es 
  $$
  \oint_\Gamma \frac{j4z-1}{\sin(z)}dz = j2\pi (j8\pi) = -16\pi^2
  $$
\end{example}

\begin{theorem}[Residuo en un polo múltiple]
  Sea $f$ con un polo de orden $m$ en $z_0$. Entonces
  $$
  \res_{z=z_0}f(z)=\frac{1}{(m-1)!}\cdot \lim_{z\to z_0} \left( \frac{d^{m-1}}{dz^{m-1}}\left[(z-z_0)^m f(z)\right] \right)
  $$
  Si $m=1$ (polo simple), entonces $(m-1)!=0!=1$ por definición, y la derivada de orden $(m-1)$ está definida para ser exactamente la propia función. Con estas convenciones, la conclusión del teorema se reduce al resultado para los residuos en polos simples cuando $m=1$.
\end{theorem}

\begin{proof}
  En alguna corona alrededor de $z_0$,
  $$
  f(z)=\frac{c_{-m}}{(z-z_0)^m} + \frac{c_{-m+1}}{(z-z_0)^{m-1}} + \cdots + \frac{c_{-1}}{z-z_0} 
  + \sum_{n=0}^\infty c_n(z-z_0)^n
  $$
  Se quiere encontrar $c_{-1}$. Al multiplicar ambos miembros por $(z-z_0)^m$, se obtiene 
  $$
  (z-z_0)^m f(z) = c_{-m} + c_{-m+1}(z-z_0) + \cdots + c_{-1}(z-z_0)^{m-1}+ \sum_{n=0}^\infty c_n(z-z_0)^{n+m}
  $$
  Si esta expresión se deriva miembro a miembro respecto de $z$, derivando una vez se obtendrá:
  $$
  g'(z) = c_{-m+1} + \cdots + c_{-1}(m-1)(z-z_0)^{m-2} + \sum_{n=0}^\infty c_n (n+m)(z-z_0)^{n+m-1}
  $$
  donde $g'(z)$ es 
  $$
  g'(z)=\frac{d}{dz}\left[(z-z_0)^m f(z)\right]
  $$
  que se ha utilizado por motivos de espacio en la hoja.

  Siguiendo con la demostración, al derivar ha desaparecido el primer coeficiente $c_{-m}$ que es una constante y en los restantes términos baja el exponente que corresponde a la potencia del paréntesis. Además la potencia del paréntesis disminuye en una unidad, quedando la expresión $g'(z)$.

  Derivando una segunda vez, tenemos
  \begin{align*}
    g''(z) =& 2c_{-m+2} + \cdots + c_{-1}(m-1)(m-2)(z-z_0)^{m-3} + \notag\\ 
            &+\sum_{n=0}^\infty c_n(n+m)(n+m-1)(z-z_0)^{n+m-2}
  \end{align*}
  Si se continúan tomando las derivadas sucesivas hasta la derivada de orden $(m-1)$ obtendremos el coeficiente $c_{-1}$ que es el residuo. Derivar dos veces nos ha servido para entender la ley de formación de las derivadas, entonces, podemos decir que, derivando $(m-1)$ veces obtenemos
  \begin{align*}
    g^{(m-1)}(z) = c_{-1}(m-1)! + \sum_{n=0}^\infty c_n (n+m)(n+m-1)\cdots(n+1)(z-z_0)^{n+1}
  \end{align*}
  Ahora, al aplicar límite para $z\to z_0$ tenemos que la expresión dentro de la sumatoria tiende a cero, y la expresión resultante es
  \begin{gather*}
    \lim_{z\to z_0}\left( \frac{d^{m-1}}{dz^{m-1}}\left[(z-z_0)^mf(z)\right]\right) = c_{-1}(m-1)! \\ 
    c_{-1} = \frac{1}{(m-1)!}\cdot\lim_{z\to z_0}\left( \frac{d^{m-1}}{dz^{m-1}}\left[(z-z_0)^mf(z)\right]\right)
  \end{gather*}
  lo que se quería demostrar.
\end{proof}

Con este resultado, podemos ver claramente que si el polo es de orden uno, entonces volvemos a la fórmula de polo simple. Entonces esto es una generalización para un polo de orden $m$.

\subsection{Residuo en el infinito}

Este caso se presenta separado a los residuos de polo simple y múltiple ya que su comportamiento y utilidad es diferente.

En el análisis complejo, trabajamos usualmente en el plano complejo finito, es decir, con valores de $z$ en $\mathbb{C}$. Pero para manejar comportamientos ``lejanos'' (cuando $\lvert z \rvert$ tiende a infinito), usamos el plano complejo extendido o \textbf{esfera de Riemann}. Esto es como agregar un punto extra llamado $\infty$ (infinito) al plano complejo, convirtiéndolo en una esfera compacta.

Esto nos permite evaluar un residuo en el infinito, para una singularidad que se presente en un valor no finito de $z$.

En el plano complejo usual, para evaluar $f(z)$ en $(z\to\infty)$, resulta claro que debemos contar con una curva $\Phi$ infinitamente grande tal que ``encierre'' a la singularidad de la ubicación no finita. Esto ya plantea una evidente dificultad, dado que la posibilidad de trazar esa curva no existe realmente.

Para poder estudiar el comportamiento de una función en $\infty$, hacemos un cambio de variable: 
\begin{equation*}
g(t)=f\left(\frac{1}{t}\right)
\end{equation*}
donde $t=1/z$. Entonces cuando $z\to\infty$ claramente $t\to0$. Entonces podemos estudiar el comportamiento de $f$ en el infinito usando una curva $\Gamma$ pequeña que encierre al origen. Para no complicar los cálculos, podemos decir que $\Gamma$ es una circunferencia.

Siendo el residuo buscado:
$$
  \res_{z=\infty}f(z)=\lim_{z\to\infty} \left(\frac{1}{j2\pi} \oint_\Phi f(z)dz\right)
$$
donde $\Phi$ debe ser una curva tan grande como se quiera.

Aplicando la transformación realizada, y usando $t$ como variable, tendríamos
\begin{equation}
\res_{t=0}f\left(\frac{1}{t}\right) = \lim_{t\to 0} \left( \frac{1}{j2\pi}\oint_\Gamma f\left(\frac{1}{t} \right) d\frac{1}{t}\right)
\label{eq:residuo_infty_cero}
\end{equation}
donde $\Gamma$ es una pequeña curva incremental alrededor del origen.

De la expresión \eqref{eq:residuo_infty_cero} podemos resolver el diferencial $d(1/t)$ para obtener una expresión respecto de la variable $t$. Consideremos la función $h(t)=t^{-1}$, entonces
$$
h(t)=\frac{1}{t} \quad \rightarrow \quad h'(t)=\frac{d}{dt}(t^{-1})=-1\cdot t^{-2} = -\frac{1}{t^2}
$$
y por definición de diferencial $(dh=h'(t)dt)$ resulta 
$$
d\left(\frac{1}{t}\right)= -\frac{1}{t^2}dt
$$
y, reemplazando en \eqref{eq:residuo_infty_cero} resultará:
\begin{equation}
  \res_{t=0}\left[f\left(\frac{1}{t}\right)\right] = \lim_{t\to 0}\left( -\frac{1}{j2\pi}\oint_\Gamma \frac{f(1/t)}{t^2} dt \right)
  \label{eq:residuo_infty_diferenciado}
\end{equation}

En este punto se puede realizar un artificio matemático con referencia a la sustitución propuesta, perfectamente válido porque no hay nada que impida realizarlo. Lo único que si debe respetarse siempre, es que, cuando hablamos de $z$ nos referimos a una curva $\Phi$ infinitamente grande y cuando hablamos de $t$ nos referimos a una curva $\Gamma$ infinitamente pequeña.

Cumpliendo con las precauciones mencionadas, la sustitución entre $z$ y $1/t$ es reversible a voluntad, porque fue formulada sin realizar ninguna condición para plantearla o retrotraerla.

Entonces, escribimos 
$$
\frac{1}{t^2} = \frac{1}{t}\cdot \frac{1}{t} = z\cdot\frac{1}{t}
$$
Luego, reemplazamos esta expresión dentro de el integrando de la ecuación \eqref{eq:residuo_infty_diferenciado} y reemplazamos $f(1/t)=f(z)$, siendo la expresión resultante 
$$
\res_{t=0}\left[f(1/t)\right] = \lim_{t\to 0} \left( -\frac{1}{j2\pi}\oint_\Gamma z\frac{f(z)}{t}dt \right) 
$$

En esta última expresión, se aprecia que $z$ y $f(z)$ a ojos de la integral son constantes, ya que se integra sobre $\Gamma$, y por tanto, la variable de integración es $t$, consecuentemente, pueden extraerse como factores constantes. Luego, quedará la siguiente expresión
\begin{equation}
\res_{t=0}\left[f(1/t)\right] = \lim_{t\to 0} \left( -\frac{zf(z)}{j2\pi} \oint_\Gamma \frac{1}{t}dt \right)
\label{eq:residuo_infinito_diferenciado}
\end{equation}
Observando la figura \ref{fig:residuo_infty_curva_gamma}, la curva $\Gamma$ alrededor del origen  y suponiendo que la misma
\begin{figure}[ht]
  \centering
  \begin{tikzpicture}[>=stealth]
    \draw[->,gray] (-1.8,0) -- (1.8,0) node[right] {\scriptsize$x$};
    \draw[->,gray] (0,-1.8) -- (0,1.8) node[above] {\scriptsize$y$};
    \begin{scope}[decoration={
        markings,
        mark=at position 0.4 with {\node[above left] {$\Gamma$};}
      }]
      \draw[very thick,red,postaction={decorate}] (0,0) circle (1.5);
    \end{scope}
    \draw[->,red,thick] (0,0) -- (40:1.5) node[midway, above] {\scriptsize\color{black}$r$};
    \draw[red] (0.3,0) arc [start angle=0, end angle=40, radius=0.3] node[right] {\scriptsize\color{black}$\theta$};
    \draw[fill] (40:1.5) circle (1pt) node[above right] {\scriptsize\color{black}$t$};
  \end{tikzpicture}
  \caption{}
  \label{fig:residuo_infty_curva_gamma}
\end{figure}
se trata de una circunferencia, la variable paramétrica $t$ se desplazará a lo largo de ella, con un cierto radio pequeño $r$ y un ángulo $\theta\in[0,2\pi]$ para dar un giro completo.

Por tanto, podemos resolver la integral de línea dentro de la expresión \eqref{eq:residuo_infty_diferenciado}. Parametrizando la curva en función de $\theta$ resulta que $t=re^{j\theta}$ y $dt=jre^{j\theta}d\theta$. Entonces
$$
\oint_\Gamma \frac{1}{t}dt = \int_0^{2\pi}\frac{1}{re^{j\theta}}\cdot jre^{j\theta}d\theta = j2\pi
$$
De manera que, volviendo a la expresión \eqref{eq:residuo_infty_diferenciado}, resulta 
$$
\res_{t=0}\left[f\left(\frac{1}{t}\right)\right]=\lim_{t\to 0}\left( -\frac{zf(z)}{j2\pi}j2\pi \right)
$$
Y, en esta última expresión ya podemos homogeneizar las variables, utilizando solamente $z$, quedando la expresión 
$$
\boxed{
\res_{z=\infty}f(z)=-\lim_{z\to\infty}zf(z)
}
$$
Que es la expresión final para calcular el residuo en el infinito de una función $f(z)$. Este residuo en el infinito puede servir para la resolución de algunas integrales, teniendo en cuenta la siguiente propiedad:
\begin{quote}
  ``Para funciones holomorfas la suma de los residuos en las singularidades aisladas más el residuo en el infinito debe dar cero.''
\end{quote}
$$
\res_{z=\infty} f(z) + \sum_{k=1}^n \res_{z=z_k} f(z) = 0
$$
Veamos un ejemplo. 

\begin{example}
  Suponiendo tener una función $f(z)$ que sea 
  $$
  f(z)=\frac{z}{(z-2)(z-3)}
  $$
  y se pretende calcular el residuo en alguna singularidad no finita de esta función fraccionaria, o residuo en el infinito coloquialmente. Resultará, aplicando la fórmula de cálculo obtenida para el residuo en el infinito:
  $$
  \res_{z=\infty}\left[\frac{z}{(z-2)(z-3)}\right]=-\lim_{z\to\infty}\left(z\frac{z}{(z-2)(z-3)}\right) = -1
  $$
  Siendo este el resultado del residuo de $f$ en el infinito.
\end{example}

Cuando se obtiene un valor para el residuo en el infinito significa que la función $f(z)$ tiene alguna singularidad no finita, o sea en las proximidades de $z\to\infty$. Cuando no es así, si el cálculo resulta indeterminado o no finito, vale decir que no se puede obtener un valor para el residuo, se interpreta entonces que no hay singularidad no finita para esa función.

En el caso de que $\res_{\infty}f(z)=0$, significa que el residuo existe y es nulo, por lo tanto, quiere decir que si hay alguna singularidad de la función en el infinito.
